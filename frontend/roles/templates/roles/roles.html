{% extends 'dashboard/dashboard.html' %}
{% load static %}
{% block style %}
<link rel="stylesheet" href="{% static 'agents/css/style.css' %}">
{% endblock %}
{% block title %}Роли{% endblock %}
{% block content %}
<div class="main-content" style="max-width:1200px;margin:40px auto 0 auto;background:#181818;border-radius:6px;box-shadow:0 2px 8px rgba(0,0,0,0.10);padding:32px 16px;">
    <h1 class="role-detail-title" style="text-align:center;margin-bottom:24px;">Роли</h1>
    <div class="list">
        <div class="list-content" id="roles-list"></div>
    </div>
    <button class="create-btn" onclick="location.href='/roles/create/'" style="display:block;margin:32px auto 0 auto;">Создать роль</button>
</div>
<div class="toast" id="toast"></div>
<script>
function showToast(msg, type='success') {
    const toast = document.getElementById('toast');
    toast.innerText = msg;
    toast.className = 'toast show';
    if (type === 'error') toast.style.background = 'linear-gradient(90deg,#ef4444,#fca5a5)';
    else toast.style.background = '';
    setTimeout(() => { toast.className = 'toast'; toast.style.background = ''; }, 2500);
}
function loadRoles() {
    fetch('http://localhost:8000/roles')
      .then(resp => resp.json())
      .then(data => {
          const list = document.getElementById('roles-list');
          list.innerHTML = '';
          data.forEach(role => {
              const div = document.createElement('div');
              div.className = 'item list-item';
              div.innerHTML = `<span>${role.name}</span> <span style='color:#aaa;'>ID: ${role.id}</span>`;
              div.onclick = () => location.href = `/roles/${role.id}/`;
              list.appendChild(div);
          });
      })
      .catch(() => showToast('Ошибка загрузки ролей', 'error'));
}
document.addEventListener('DOMContentLoaded', loadRoles);
</script>
{% endblock %}